!function(c){var t={};function g(I){if(t[I])return t[I].exports;var n=t[I]={i:I,l:!1,exports:{}};return c[I].call(n.exports,n,n.exports,g),n.l=!0,n.exports}g.m=c,g.c=t,g.d=function(c,t,I){g.o(c,t)||Object.defineProperty(c,t,{enumerable:!0,get:I})},g.r=function(c){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})},g.t=function(c,t){if(1&t&&(c=g(c)),8&t)return c;if(4&t&&"object"==typeof c&&c&&c.__esModule)return c;var I=Object.create(null);if(g.r(I),Object.defineProperty(I,"default",{enumerable:!0,value:c}),2&t&&"string"!=typeof c)for(var n in c)g.d(I,n,function(t){return c[t]}.bind(null,n));return I},g.n=function(c){var t=c&&c.__esModule?function(){return c.default}:function(){return c};return g.d(t,"a",t),t},g.o=function(c,t){return Object.prototype.hasOwnProperty.call(c,t)},g.p="",g(g.s=0)}([function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n\n// CONCATENATED MODULE: ./src/js/weatherInformationClass.js\nclass WeatherInformation {\r\n  constructor(weatherInfo) {\r\n    (this.location = weatherInfo.name),\r\n      (this.country = weatherInfo.sys.country);\r\n    (this.date = new Date()),\r\n      (this.temp = weatherInfo.main.temp),\r\n      (this.iconName = weatherInfo.weather[0].main),\r\n      (this.pressure = weatherInfo.main.pressure),\r\n      (this.humidity = weatherInfo.main.humidity),\r\n      (this.windSpped = weatherInfo.wind.speed);\r\n  }\r\n\r\n  setLocation() {\r\n    const locationID = document.getElementsByClassName(\r\n      "headText__location--js"\r\n    )[0];\r\n    locationID.innerHTML = `in ${this.location}, ${this.country}`;\r\n  }\r\n  setDate() {\r\n    const dateID = document.getElementsByClassName("headText__date--js")[0];\r\n    dateID.innerHTML = `Today ${this.date.getDate()}th, ${this.date.toLocaleString(\r\n      "en-EN",\r\n      { month: "long" }\r\n    )}`;\r\n  }\r\n\r\n  setTemp() {\r\n    const tempID = document.getElementsByClassName("headText--degrees-js")[0];\r\n    tempID.innerHTML = `${this.temp.toFixed(1)} Â°C`;\r\n  }\r\n\r\n  setPressure() {\r\n    const pressureID = document.getElementsByClassName(\r\n      "weatherToday__pressure--js"\r\n    )[0];\r\n    pressureID.innerHTML = `${this.pressure} hPa`;\r\n  }\r\n\r\n  setHumidity() {\r\n    const humidityID = document.getElementsByClassName(\r\n      "weatherToday__humidity--js"\r\n    )[0];\r\n    humidityID.innerHTML = `${this.humidity} %`;\r\n  }\r\n\r\n  setWindSpeed() {\r\n    const windSpeedID = document.getElementsByClassName(\r\n      "weatherToday__windSpeed--js"\r\n    )[0];\r\n    windSpeedID.innerHTML = `${this.windSpped} m/s`;\r\n  }\r\n\r\n  setWeatherInformation() {\r\n    this.setLocation();\r\n    this.setDate();\r\n    this.setTemp();\r\n    this.setPressure();\r\n    this.setHumidity();\r\n    this.setWindSpeed();\r\n  }\r\n\r\n  weatherIcon(weather) {\r\n    let currentDate = new Date();\r\n    currentDate = currentDate.getHours();\r\n    switch (weather) {\r\n      case "thunderstorm":\r\n        return "storm.svg";\r\n        break;\r\n      case "Drizzle":\r\n        return "Drizzle.svg";\r\n        break;\r\n      case "Rain":\r\n        return "Rain.svg";\r\n        break;\r\n      case "Snow":\r\n        return "Snowflake.svg";\r\n        break;\r\n      case "Atmosphere":\r\n        return "fog.svg";\r\n        break;\r\n      case "Clear":\r\n        if (currentDate <= 20) {\r\n          return "sun.svg";\r\n          break;\r\n        } else {\r\n          return "moon.svg";\r\n          break;\r\n        }\r\n      case "Clouds":\r\n        return "Clouds.svg";\r\n        break;\r\n    }\r\n  }\r\n\r\n  setImage() {\r\n    const imageID = document.getElementsByClassName("weatherImage--js")[0];\r\n    const weatherName = this.weatherIcon(this.iconName);\r\n    imageID.src = `assets/img/${weatherName}`;\r\n  }\r\n  roundTemp(temp) {\r\n    return Math.round((temp * 100) / 100);\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/js/chartClass.js\nclass Chart {\r\n    constructor(weatherData, axisXposition) {\r\n      this.axisXposition = axisXposition;\r\n      this.weatherByHour = weatherData;\r\n      this.condition = false;\r\n      this.state = {};\r\n      this.tooltip = document.getElementsByClassName("chartTemp__tooltip")[0];\r\n      this.canvas = document.getElementById("chartTemp__canvas");\r\n      this.ctx = this.canvas.getContext("2d");\r\n    }\r\n  \r\n    canvasDimensions() {\r\n      this.canvas.width = 660;\r\n      this.canvas.height = 309;\r\n    }\r\n  \r\n    blocks(count) {\r\n      return count * 40;\r\n    }\r\n  \r\n    drawGrid() {\r\n      let gridX = 40;\r\n      let gridY = 40;\r\n      const cellSize = 40;\r\n      this.ctx.beginPath();\r\n      this.ctx.strokeStyle = "lightgrey";\r\n    \r\n      while (gridX <= this.canvas.width - 20) {\r\n        this.ctx.moveTo(gridX, 20);\r\n        this.ctx.lineTo(gridX, this.canvas.height - 20);\r\n        gridX += cellSize;\r\n      }\r\n      while (gridY <= this.canvas.height - 20) {\r\n        this.ctx.moveTo(20, gridY);\r\n        this.ctx.lineTo(this.canvas.width - 10, gridY);\r\n        gridY += cellSize;\r\n      }\r\n      this.ctx.stroke();\r\n    }\r\n  \r\n    async drawAxis(hours) {\r\n      this.ctx.beginPath();\r\n      this.ctx.strokeStyle = "black";\r\n      this.ctx.moveTo(this.blocks(1), this.blocks(1 / 2));\r\n      this.ctx.lineTo(this.blocks(1), this.blocks(7));\r\n      this.ctx.lineTo(this.blocks(16), this.blocks(7));\r\n    \r\n      this.ctx.moveTo(this.blocks(1), this.blocks(7));\r\n      let text = 0;\r\n      let textY = this.blocks(7);\r\n      for (let i = 1; i <= 7; i++) {\r\n        this.ctx.strokeText(text, this.blocks(1 / 2), textY);\r\n        textY -= 40;\r\n        text += 5;\r\n      }\r\n    \r\n      this.ctx.moveTo(this.blocks(2), this.blocks(7));\r\n      let textX = this.blocks(1.9);\r\n    \r\n      for (let i = 0; i <= 15; i++) {\r\n        this.ctx.strokeText(hours[i], textX, this.blocks(7.5));\r\n        textX += 40;\r\n      }\r\n      this.ctx.stroke();\r\n    }\r\n    timestampToTime(stamp) {\r\n      let date = new Date(stamp * 1000);\r\n      return date.getHours();\r\n    }\r\n    \r\n    mapAndFilter(tempArray) {\r\n      tempArray = tempArray.map((el) => this.timestampToTime(el));\r\n      tempArray = tempArray.filter((el) => el % 2 == 0);\r\n      return tempArray;\r\n    }\r\n    \r\n    temperatureToChartCoords(temp){\r\n      let temperature = temp.map((el) => el / 5);\r\n      temperature = temperature.slice(0,15);\r\n      return temperature;\r\n    }\r\n    \r\n    getHoursCoords() {\r\n      let hourOfTemp = [...Array(17).keys()]\r\n      hourOfTemp = hourOfTemp.slice(2, 17);\r\n    \r\n      return hourOfTemp;\r\n    }\r\n    \r\n    drawChart(temperature) {\r\n      const tempHours = this.getHoursCoords();\r\n      let i = 1;\r\n      const context = this.ctx\r\n      const block = this.blocks.bind(this);\r\n      const axisXposition = this.axisXposition;\r\n      function animation() {\r\n        if (i <= temperature.length) {\r\n          window.requestAnimationFrame(animation);\r\n        }\r\n        context.strokeStyle = "#FFE74A";\r\n        context.lineWidth = 3;\r\n        context.beginPath();\r\n        context.moveTo(block(tempHours[i-1]), axisXposition - block(temperature[i-1]));\r\n        context.arc(block(tempHours[i-1]), axisXposition - block(temperature[i-1]), 3, 0, Math.PI * 2, true);\r\n        context.lineTo(block(tempHours[i]), axisXposition - block(temperature[i]));\r\n        context.stroke();\r\n        i++;\r\n      }\r\n      animation();\r\n    }\r\n    \r\n    async waitForGrid(ms) {\r\n      return new Promise(r => setTimeout(r, ms));\r\n    }\r\n    \r\n    getMousePosition(evt) {\r\n      let rect = this.canvas.getBoundingClientRect();\r\n      return {\r\n        x: evt.clientX - rect.left,\r\n        y: evt.clientY - rect.top\r\n      };\r\n    }\r\n    \r\n    filterTemperature(temperature) {\r\n      const temp = temperature\r\n        .map((obj) => obj.temp)\r\n        .filter((el, index) => index % 2 == 0);\r\n    \r\n      return temp;\r\n    }\r\n    \r\n    temperatureToPixel(temp){\r\n      temp = temp.map(el => this.axisXposition - this.blocks(el));\r\n      return temp;\r\n    }\r\n    \r\n    hoursToPixel(hours) {\r\n      const hourrs = hours.map(el => this.blocks(el));\r\n      return hourrs;\r\n    }\r\n    \r\n    createTempObj(hour, temp, hourOfTemp, tempInHour){\r\n      const tempPointCoords = [];\r\n      for (let i = 0; i < temp.length; i++){\r\n        tempPointCoords.push({\r\n          x: hour[i],\r\n          y: temp[i],\r\n          xmin: hour[i] - 3,\r\n          xmax: hour[i] + 3,\r\n          ymin: temp[i] - 3,\r\n          ymax: temp[i] + 3,\r\n          hourTemp: {\r\n            hour: hourOfTemp[i],\r\n            temp: tempInHour[i]\r\n          },\r\n    \r\n        })\r\n      }\r\n      return tempPointCoords;\r\n    }\r\n    \r\n    drawPoint(coords = {}, radius, color = \'white\') {\r\n      const mouseCoordinate = coords;\r\n      this.ctx.strokeStyle = color;\r\n      this.ctx.beginPath();\r\n      this.ctx.moveTo(mouseCoordinate.x, mouseCoordinate.y);\r\n      this.ctx.arc(mouseCoordinate.x, mouseCoordinate.y, radius, 0, Math.PI * 2, true);\r\n      this.ctx.fillStyle = color;\r\n      this.ctx.fill();\r\n      this.ctx.stroke();\r\n    }\r\n    \r\n  \r\n    addPopUp(tempPoint) {\r\n      this.canvas.addEventListener(\'mousemove\', (e) => {\r\n        const mouseCoords = this.getMousePosition(e);\r\n        let boools = tempPoint.filter(el => {\r\n          const a = el.xmin <= mouseCoords.x;\r\n          const b = mouseCoords.x <= el.xmax;\r\n          const c = el.ymin <= mouseCoords.y;\r\n          const d = mouseCoords.y <= el.ymax;\r\n          return (a && b && c && d)})\r\n        \r\n        if(boools.length) {\r\n          this.drawPoint(boools[0], 1);\r\n          this.state = {...boools[0]};\r\n          this.condition = true;\r\n          if (this.canvas.width - (this.state.x + 5) <= 80){\r\n            this.tooltip.style.left = `${this.state.x - 85}px`\r\n            this.tooltip.style.top = `${this.state.y - 35}px`;\r\n            \r\n          }\r\n          else {\r\n            this.tooltip.style.left = `${this.state.x + 5}px`;\r\n            this.tooltip.style.top = `${this.state.y - 35}px`;\r\n          }\r\n          this.tooltip.style.display = \'flex\';\r\n          this.tooltip.innerHTML = `Time: ${this.state.hourTemp.hour}:00, Temp: ${this.state.hourTemp.temp}Â°C`;\r\n        } \r\n        else if(!boools.length) {\r\n          this.drawPoint(this.state, 3, "#FFE74A");\r\n          this.condition = false;\r\n          this.state = {};\r\n          this.tooltip.style.display = \'none\';\r\n        } \r\n      })\r\n    }\r\n    \r\n    async chart() {\r\n      const hourOfWeather = this.mapAndFilter(this.weatherByHour.map((obj) => obj.dt));\r\n      let temperature = this.filterTemperature(this.weatherByHour);\r\n      const temperatureCoords = this.temperatureToChartCoords(temperature);\r\n      \r\n      const tempPixels = this.temperatureToPixel(temperatureCoords, this.axisXposition);\r\n      const hoursPixels = this.hoursToPixel(this.getHoursCoords());\r\n      \r\n      const tempPoints = this.createTempObj(hoursPixels, tempPixels, hourOfWeather, temperature);\r\n    \r\n      this.canvasDimensions();\r\n      this.drawGrid();\r\n      this.drawAxis(hourOfWeather);\r\n      await this.waitForGrid(500);\r\n      this.drawChart(temperatureCoords)\r\n      this.addPopUp(tempPoints);\r\n    }\r\n  \r\n  }\n// CONCATENATED MODULE: ./src/js/weekForecastClass.js\nclass WeekForecast {\r\n  constructor(weekForecastData) {\r\n    this.weekData = weekForecastData;\r\n    this.weatherForecastContainer = document.getElementsByClassName(\r\n      "weatherForecast--js"\r\n    );\r\n    this.weatherForecastContainer = this.weatherForecastContainer[0];\r\n  }\r\n\r\n  sliceWeekDataArray() {\r\n    this.weekData = this.weekData.slice(1, 8);\r\n  }\r\n\r\n  getTimestampToTime(timestamp) {\r\n    const time = new Date(timestamp * 1000);\r\n    return time.getDay();\r\n  }\r\n\r\n  getNameOfWeek(number) {\r\n    switch (number) {\r\n      case 0:\r\n        return "Sun";\r\n        break;\r\n      case 1:\r\n        return "Mon";\r\n        break;\r\n      case 2:\r\n        return "Tue";\r\n        break;\r\n      case 3:\r\n        return "Wed";\r\n        break;\r\n      case 4:\r\n        return "Thur";\r\n        break;\r\n      case 5:\r\n        return "Fri";\r\n        break;\r\n      case 6:\r\n        return "Sat";\r\n        break;\r\n    }\r\n  }\r\n  getWeatherParameters() {\r\n    this.weekData = this.weekData.map((el) => {\r\n      return {\r\n        day: this.getNameOfWeek(this.getTimestampToTime(el.dt)),\r\n        temp: el.temp.day,\r\n        weather: el.weather[0].main,\r\n      };\r\n    });\r\n    console.log(this.weekData);\r\n  }\r\n\r\n  putWeatherIntoSection() {\r\n    this.weatherForecastContainer.innerHTML = "";\r\n    this.weekData.forEach((el) => {\r\n      this.weatherForecastContainer.innerHTML += `<div class="weatherForecast__day weatherForecast__day--js"><img class="weatherForecast__dayElement" src=\'assets/img/weatherIcons/${this.weatherIcon(\r\n        el.weather\r\n      )}\' alt=\'\'></img><div class="weatherForecast__dayElement"><p>${\r\n        el.day\r\n      }<br>${el.temp}</p></div></div>`;\r\n    });\r\n  }\r\n\r\n  addWeatherForecast() {\r\n    this.sliceWeekDataArray();\r\n    this.getWeatherParameters();\r\n    this.putWeatherIntoSection();\r\n  }\r\n\r\n  weatherIcon(weather) {\r\n    let currentDate = new Date();\r\n    currentDate = currentDate.getHours();\r\n    switch (weather) {\r\n      case "thunderstorm":\r\n        return "Storm.svg";\r\n        break;\r\n      case "Drizzle":\r\n        return "Drizzle.svg";\r\n        break;\r\n      case "Rain":\r\n        return "Rain.svg";\r\n        break;\r\n      case "Snow":\r\n        return "Snowflake.svg";\r\n        break;\r\n      case "Atmosphere":\r\n        return "Fog.svg";\r\n        break;\r\n      case "Clear":\r\n        if (currentDate <= 20) {\r\n          return "Sun.svg";\r\n          break;\r\n        } else {\r\n          return "Moon.svg";\r\n          break;\r\n        }\r\n      case "Clouds":\r\n        return "Clouds.svg";\r\n        break;\r\n    }\r\n  }\r\n}\r\n\n// CONCATENATED MODULE: ./src/js/main.js\n\r\n\r\n\r\n\r\n// service worker registration - remove if you\'re not going to use it\r\n\r\nif ("serviceWorker" in navigator) {\r\n  window.addEventListener("load", function () {\r\n    navigator.serviceWorker.register("serviceworker.js").then(\r\n      function (registration) {\r\n        // Registration was successful\r\n        console.log(\r\n          "ServiceWorker registration successful with scope: ",\r\n          registration.scope\r\n        );\r\n      },\r\n      function (err) {\r\n        // registration failed :(\r\n        console.log("ServiceWorker registration failed: ", err);\r\n      }\r\n    );\r\n  });\r\n}\r\n\r\n// place your code below\r\nconst apiKey = "53c5e97675c8d3d8da07e56aec5a3a22";\r\nconst axisXposition = 280; // X axis is on 280px Canvas Height;\r\nlet classStatus = false;\r\n\r\n(function () {\r\n  let lastTime = 0;\r\n  let vendors = ["ms", "moz", "webkit", "o"];\r\n  for (let x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n    window.requestAnimationFrame = window[vendors[x] + "RequestAnimationFrame"];\r\n    window.cancelAnimationFrame =\r\n      window[vendors[x] + "CancelAnimationFrame"] ||\r\n      window[vendors[x] + "CancelRequestAnimationFrame"];\r\n  }\r\n\r\n  if (!window.requestAnimationFrame)\r\n    window.requestAnimationFrame = function (callback, element) {\r\n      let currTime = new Date().getTime();\r\n      let timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n      let id = window.setTimeout(function () {\r\n        callback(currTime + timeToCall);\r\n      }, timeToCall);\r\n      lastTime = currTime + timeToCall;\r\n      return id;\r\n    };\r\n\r\n  if (!window.cancelAnimationFrame)\r\n    window.cancelAnimationFrame = function (id) {\r\n      clearTimeout(id);\r\n    };\r\n})();\r\n\r\nfunction error(err) {\r\n  console.warn(`ERROR(${err.code}): ${err.message}`);\r\n}\r\n\r\nconst options = {\r\n  enableHighAccuracy: true,\r\n  timeout: 5000,\r\n  maximumAge: 0,\r\n};\r\n\r\nfunction main_location() {\r\n  return new Promise((resolve, reject) =>\r\n    navigator.geolocation.getCurrentPosition(resolve, error)\r\n  );\r\n}\r\n\r\nasync function getLocation(location) {\r\n  let position = location;\r\n  let weatherByPosition;\r\n  let weatherByHour;\r\n  let nextSevenDays;\r\n  if (typeof position === "object") {\r\n    position = await position.coords;\r\n    const { latitude, longitude } = position;\r\n\r\n    weatherByPosition = await fetch(\r\n      `https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${apiKey}&units=metric&lang=pl`\r\n    );\r\n    weatherByPosition = await weatherByPosition.json();\r\n\r\n    weatherByHour = await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${latitude}&lon=${longitude}&\r\n    exclude=hourly&appid=${apiKey}&units=metric`);\r\n    weatherByHour = await weatherByHour.json();\r\n    weatherByHour = weatherByHour.hourly;\r\n\r\n    nextSevenDays = await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${latitude}&lon=${longitude}&\r\n    exclude=daily&appid=${apiKey}&units=metric`);\r\n    nextSevenDays = await nextSevenDays.json();\r\n    nextSevenDays = nextSevenDays.daily;\r\n  } else {\r\n    weatherByPosition = await fetch(\r\n      `https://api.openweathermap.org/data/2.5/weather?q=${position}&appid=${apiKey}&units=metric`\r\n    );\r\n    weatherByPosition = await weatherByPosition.json();\r\n\r\n    const coords = weatherByPosition.coord;\r\n    console.log(coords);\r\n    weatherByHour = await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${coords.lat}&lon=${coords.lon}&\r\n    exclude=hourly&appid=${apiKey}&units=metric`);\r\n    weatherByHour = await weatherByHour.json();\r\n\r\n    weatherByHour = weatherByHour.hourly;\r\n\r\n    nextSevenDays = await fetch(`https://api.openweathermap.org/data/2.5/onecall?lat=${coords.lat}&lon=${coords.lon}&\r\n    exclude=daily&appid=${apiKey}&units=metric`);\r\n    nextSevenDays = await nextSevenDays.json();\r\n    nextSevenDays = nextSevenDays.daily;\r\n  }\r\n\r\n  const weatherData = new WeatherInformation(weatherByPosition);\r\n  weatherData.setWeatherInformation();\r\n  const chart = new Chart(weatherByHour, axisXposition);\r\n  chart.chart();\r\n  const forecastForWeek = new WeekForecast(nextSevenDays);\r\n  forecastForWeek.addWeatherForecast();\r\n}\r\n\r\nconst localization = document.getElementsByClassName(\r\n  "header__geolocalization--buttonJS"\r\n)[0];\r\nconst searchButton = document.getElementsByClassName(\r\n  "header__search--buttonJS"\r\n)[0];\r\nconst inputField = document.getElementsByClassName(\r\n  "header__search--inputJS"\r\n)[0];\r\n\r\nlocalization.addEventListener("click", async () => {\r\n  const locations = await main_location();\r\n  await getLocation(locations);\r\n  if (!classStatus) {\r\n    replaceClasses();\r\n    classStatus = true;\r\n  }\r\n});\r\n\r\nsearchButton.addEventListener("click", async () => {\r\n  if (!inputField.value) {\r\n    alert("please type your city name");\r\n  } else if (inputField.value) {\r\n    try {\r\n      await getLocation(inputField.value);\r\n\r\n      if (!classStatus) {\r\n        replaceClasses();\r\n        classStatus = true;\r\n      }\r\n    } catch (error) {\r\n      alert("Please type corret city name");\r\n    }\r\n  }\r\n});\r\n\r\nfunction replaceClasses() {\r\n  const header = document.getElementsByClassName("header--firstLoad")[0];\r\n  const main = document.getElementsByClassName("main__container--firstLoad")[0];\r\n  const footer = document.getElementsByClassName("footer--firstLoad")[0];\r\n\r\n  header.classList.replace("header--firstLoad", "header");\r\n  main.classList.replace("main__container--firstLoad", "main__container");\r\n  footer.classList.replace("footer--firstLoad", "footer__image");\r\n}\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9zcmMvanMvd2VhdGhlckluZm9ybWF0aW9uQ2xhc3MuanM/M2IxZiIsIndlYnBhY2s6Ly8vLi9zcmMvanMvY2hhcnRDbGFzcy5qcz8yMDJkIiwid2VicGFjazovLy8uL3NyYy9qcy93ZWVrRm9yZWNhc3RDbGFzcy5qcz8yMTU4Iiwid2VicGFjazovLy8uL3NyYy9qcy9tYWluLmpzPzkyOTEiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxjQUFjLElBQUksYUFBYTtBQUNoRTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0Msb0JBQW9CLE1BQU07QUFDMUQ7QUFDQSxPQUFPO0FBQ1AsTUFBTTtBQUNOOztBQUVBO0FBQ0E7QUFDQSwwQkFBMEIscUJBQXFCO0FBQy9DOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGNBQWM7QUFDNUM7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsY0FBYztBQUM1Qzs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixlQUFlO0FBQzlDOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxZQUFZO0FBQzVDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3RHTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNB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O0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiMC5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBXZWF0aGVySW5mb3JtYXRpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHdlYXRoZXJJbmZvKSB7XHJcbiAgICAodGhpcy5sb2NhdGlvbiA9IHdlYXRoZXJJbmZvLm5hbWUpLFxyXG4gICAgICAodGhpcy5jb3VudHJ5ID0gd2VhdGhlckluZm8uc3lzLmNvdW50cnkpO1xyXG4gICAgKHRoaXMuZGF0ZSA9IG5ldyBEYXRlKCkpLFxyXG4gICAgICAodGhpcy50ZW1wID0gd2VhdGhlckluZm8ubWFpbi50ZW1wKSxcclxuICAgICAgKHRoaXMuaWNvbk5hbWUgPSB3ZWF0aGVySW5mby53ZWF0aGVyWzBdLm1haW4pLFxyXG4gICAgICAodGhpcy5wcmVzc3VyZSA9IHdlYXRoZXJJbmZvLm1haW4ucHJlc3N1cmUpLFxyXG4gICAgICAodGhpcy5odW1pZGl0eSA9IHdlYXRoZXJJbmZvLm1haW4uaHVtaWRpdHkpLFxyXG4gICAgICAodGhpcy53aW5kU3BwZWQgPSB3ZWF0aGVySW5mby53aW5kLnNwZWVkKTtcclxuICB9XHJcblxyXG4gIHNldExvY2F0aW9uKCkge1xyXG4gICAgY29uc3QgbG9jYXRpb25JRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXHJcbiAgICAgIFwiaGVhZFRleHRfX2xvY2F0aW9uLS1qc1wiXHJcbiAgICApWzBdO1xyXG4gICAgbG9jYXRpb25JRC5pbm5lckhUTUwgPSBgaW4gJHt0aGlzLmxvY2F0aW9ufSwgJHt0aGlzLmNvdW50cnl9YDtcclxuICB9XHJcbiAgc2V0RGF0ZSgpIHtcclxuICAgIGNvbnN0IGRhdGVJRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJoZWFkVGV4dF9fZGF0ZS0tanNcIilbMF07XHJcbiAgICBkYXRlSUQuaW5uZXJIVE1MID0gYFRvZGF5ICR7dGhpcy5kYXRlLmdldERhdGUoKX10aCwgJHt0aGlzLmRhdGUudG9Mb2NhbGVTdHJpbmcoXHJcbiAgICAgIFwiZW4tRU5cIixcclxuICAgICAgeyBtb250aDogXCJsb25nXCIgfVxyXG4gICAgKX1gO1xyXG4gIH1cclxuXHJcbiAgc2V0VGVtcCgpIHtcclxuICAgIGNvbnN0IHRlbXBJRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJoZWFkVGV4dC0tZGVncmVlcy1qc1wiKVswXTtcclxuICAgIHRlbXBJRC5pbm5lckhUTUwgPSBgJHt0aGlzLnRlbXAudG9GaXhlZCgxKX0gwrBDYDtcclxuICB9XHJcblxyXG4gIHNldFByZXNzdXJlKCkge1xyXG4gICAgY29uc3QgcHJlc3N1cmVJRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXHJcbiAgICAgIFwid2VhdGhlclRvZGF5X19wcmVzc3VyZS0tanNcIlxyXG4gICAgKVswXTtcclxuICAgIHByZXNzdXJlSUQuaW5uZXJIVE1MID0gYCR7dGhpcy5wcmVzc3VyZX0gaFBhYDtcclxuICB9XHJcblxyXG4gIHNldEh1bWlkaXR5KCkge1xyXG4gICAgY29uc3QgaHVtaWRpdHlJRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXHJcbiAgICAgIFwid2VhdGhlclRvZGF5X19odW1pZGl0eS0tanNcIlxyXG4gICAgKVswXTtcclxuICAgIGh1bWlkaXR5SUQuaW5uZXJIVE1MID0gYCR7dGhpcy5odW1pZGl0eX0gJWA7XHJcbiAgfVxyXG5cclxuICBzZXRXaW5kU3BlZWQoKSB7XHJcbiAgICBjb25zdCB3aW5kU3BlZWRJRCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXHJcbiAgICAgIFwid2VhdGhlclRvZGF5X193aW5kU3BlZWQtLWpzXCJcclxuICAgIClbMF07XHJcbiAgICB3aW5kU3BlZWRJRC5pbm5lckhUTUwgPSBgJHt0aGlzLndpbmRTcHBlZH0gbS9zYDtcclxuICB9XHJcblxyXG4gIHNldFdlYXRoZXJJbmZvcm1hdGlvbigpIHtcclxuICAgIHRoaXMuc2V0TG9jYXRpb24oKTtcclxuICAgIHRoaXMuc2V0RGF0ZSgpO1xyXG4gICAgdGhpcy5zZXRUZW1wKCk7XHJcbiAgICB0aGlzLnNldFByZXNzdXJlKCk7XHJcbiAgICB0aGlzLnNldEh1bWlkaXR5KCk7XHJcbiAgICB0aGlzLnNldFdpbmRTcGVlZCgpO1xyXG4gIH1cclxuXHJcbiAgd2VhdGhlckljb24od2VhdGhlcikge1xyXG4gICAgbGV0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKTtcclxuICAgIGN1cnJlbnREYXRlID0gY3VycmVudERhdGUuZ2V0SG91cnMoKTtcclxuICAgIHN3aXRjaCAod2VhdGhlcikge1xyXG4gICAgICBjYXNlIFwidGh1bmRlcnN0b3JtXCI6XHJcbiAgICAgICAgcmV0dXJuIFwic3Rvcm0uc3ZnXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJEcml6emxlXCI6XHJcbiAgICAgICAgcmV0dXJuIFwiRHJpenpsZS5zdmdcIjtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIlJhaW5cIjpcclxuICAgICAgICByZXR1cm4gXCJSYWluLnN2Z1wiO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFwiU25vd1wiOlxyXG4gICAgICAgIHJldHVybiBcIlNub3dmbGFrZS5zdmdcIjtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIkF0bW9zcGhlcmVcIjpcclxuICAgICAgICByZXR1cm4gXCJmb2cuc3ZnXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJDbGVhclwiOlxyXG4gICAgICAgIGlmIChjdXJyZW50RGF0ZSA8PSAyMCkge1xyXG4gICAgICAgICAgcmV0dXJuIFwic3VuLnN2Z1wiO1xyXG4gICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHJldHVybiBcIm1vb24uc3ZnXCI7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICAgIGNhc2UgXCJDbG91ZHNcIjpcclxuICAgICAgICByZXR1cm4gXCJDbG91ZHMuc3ZnXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRJbWFnZSgpIHtcclxuICAgIGNvbnN0IGltYWdlSUQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwid2VhdGhlckltYWdlLS1qc1wiKVswXTtcclxuICAgIGNvbnN0IHdlYXRoZXJOYW1lID0gdGhpcy53ZWF0aGVySWNvbih0aGlzLmljb25OYW1lKTtcclxuICAgIGltYWdlSUQuc3JjID0gYGFzc2V0cy9pbWcvJHt3ZWF0aGVyTmFtZX1gO1xyXG4gIH1cclxuICByb3VuZFRlbXAodGVtcCkge1xyXG4gICAgcmV0dXJuIE1hdGgucm91bmQoKHRlbXAgKiAxMDApIC8gMTAwKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIENoYXJ0IHtcclxuICAgIGNvbnN0cnVjdG9yKHdlYXRoZXJEYXRhLCBheGlzWHBvc2l0aW9uKSB7XHJcbiAgICAgIHRoaXMuYXhpc1hwb3NpdGlvbiA9IGF4aXNYcG9zaXRpb247XHJcbiAgICAgIHRoaXMud2VhdGhlckJ5SG91ciA9IHdlYXRoZXJEYXRhO1xyXG4gICAgICB0aGlzLmNvbmRpdGlvbiA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnN0YXRlID0ge307XHJcbiAgICAgIHRoaXMudG9vbHRpcCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJjaGFydFRlbXBfX3Rvb2x0aXBcIilbMF07XHJcbiAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjaGFydFRlbXBfX2NhbnZhc1wiKTtcclxuICAgICAgdGhpcy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBjYW52YXNEaW1lbnNpb25zKCkge1xyXG4gICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IDY2MDtcclxuICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gMzA5O1xyXG4gICAgfVxyXG4gIFxyXG4gICAgYmxvY2tzKGNvdW50KSB7XHJcbiAgICAgIHJldHVybiBjb3VudCAqIDQwO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZHJhd0dyaWQoKSB7XHJcbiAgICAgIGxldCBncmlkWCA9IDQwO1xyXG4gICAgICBsZXQgZ3JpZFkgPSA0MDtcclxuICAgICAgY29uc3QgY2VsbFNpemUgPSA0MDtcclxuICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XHJcbiAgICAgIHRoaXMuY3R4LnN0cm9rZVN0eWxlID0gXCJsaWdodGdyZXlcIjtcclxuICAgIFxyXG4gICAgICB3aGlsZSAoZ3JpZFggPD0gdGhpcy5jYW52YXMud2lkdGggLSAyMCkge1xyXG4gICAgICAgIHRoaXMuY3R4Lm1vdmVUbyhncmlkWCwgMjApO1xyXG4gICAgICAgIHRoaXMuY3R4LmxpbmVUbyhncmlkWCwgdGhpcy5jYW52YXMuaGVpZ2h0IC0gMjApO1xyXG4gICAgICAgIGdyaWRYICs9IGNlbGxTaXplO1xyXG4gICAgICB9XHJcbiAgICAgIHdoaWxlIChncmlkWSA8PSB0aGlzLmNhbnZhcy5oZWlnaHQgLSAyMCkge1xyXG4gICAgICAgIHRoaXMuY3R4Lm1vdmVUbygyMCwgZ3JpZFkpO1xyXG4gICAgICAgIHRoaXMuY3R4LmxpbmVUbyh0aGlzLmNhbnZhcy53aWR0aCAtIDEwLCBncmlkWSk7XHJcbiAgICAgICAgZ3JpZFkgKz0gY2VsbFNpemU7XHJcbiAgICAgIH1cclxuICAgICAgdGhpcy5jdHguc3Ryb2tlKCk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBhc3luYyBkcmF3QXhpcyhob3Vycykge1xyXG4gICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgdGhpcy5jdHguc3Ryb2tlU3R5bGUgPSBcImJsYWNrXCI7XHJcbiAgICAgIHRoaXMuY3R4Lm1vdmVUbyh0aGlzLmJsb2NrcygxKSwgdGhpcy5ibG9ja3MoMSAvIDIpKTtcclxuICAgICAgdGhpcy5jdHgubGluZVRvKHRoaXMuYmxvY2tzKDEpLCB0aGlzLmJsb2Nrcyg3KSk7XHJcbiAgICAgIHRoaXMuY3R4LmxpbmVUbyh0aGlzLmJsb2NrcygxNiksIHRoaXMuYmxvY2tzKDcpKTtcclxuICAgIFxyXG4gICAgICB0aGlzLmN0eC5tb3ZlVG8odGhpcy5ibG9ja3MoMSksIHRoaXMuYmxvY2tzKDcpKTtcclxuICAgICAgbGV0IHRleHQgPSAwO1xyXG4gICAgICBsZXQgdGV4dFkgPSB0aGlzLmJsb2Nrcyg3KTtcclxuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gNzsgaSsrKSB7XHJcbiAgICAgICAgdGhpcy5jdHguc3Ryb2tlVGV4dCh0ZXh0LCB0aGlzLmJsb2NrcygxIC8gMiksIHRleHRZKTtcclxuICAgICAgICB0ZXh0WSAtPSA0MDtcclxuICAgICAgICB0ZXh0ICs9IDU7XHJcbiAgICAgIH1cclxuICAgIFxyXG4gICAgICB0aGlzLmN0eC5tb3ZlVG8odGhpcy5ibG9ja3MoMiksIHRoaXMuYmxvY2tzKDcpKTtcclxuICAgICAgbGV0IHRleHRYID0gdGhpcy5ibG9ja3MoMS45KTtcclxuICAgIFxyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSAxNTsgaSsrKSB7XHJcbiAgICAgICAgdGhpcy5jdHguc3Ryb2tlVGV4dChob3Vyc1tpXSwgdGV4dFgsIHRoaXMuYmxvY2tzKDcuNSkpO1xyXG4gICAgICAgIHRleHRYICs9IDQwO1xyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuY3R4LnN0cm9rZSgpO1xyXG4gICAgfVxyXG4gICAgdGltZXN0YW1wVG9UaW1lKHN0YW1wKSB7XHJcbiAgICAgIGxldCBkYXRlID0gbmV3IERhdGUoc3RhbXAgKiAxMDAwKTtcclxuICAgICAgcmV0dXJuIGRhdGUuZ2V0SG91cnMoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgbWFwQW5kRmlsdGVyKHRlbXBBcnJheSkge1xyXG4gICAgICB0ZW1wQXJyYXkgPSB0ZW1wQXJyYXkubWFwKChlbCkgPT4gdGhpcy50aW1lc3RhbXBUb1RpbWUoZWwpKTtcclxuICAgICAgdGVtcEFycmF5ID0gdGVtcEFycmF5LmZpbHRlcigoZWwpID0+IGVsICUgMiA9PSAwKTtcclxuICAgICAgcmV0dXJuIHRlbXBBcnJheTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgdGVtcGVyYXR1cmVUb0NoYXJ0Q29vcmRzKHRlbXApe1xyXG4gICAgICBsZXQgdGVtcGVyYXR1cmUgPSB0ZW1wLm1hcCgoZWwpID0+IGVsIC8gNSk7XHJcbiAgICAgIHRlbXBlcmF0dXJlID0gdGVtcGVyYXR1cmUuc2xpY2UoMCwxNSk7XHJcbiAgICAgIHJldHVybiB0ZW1wZXJhdHVyZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0SG91cnNDb29yZHMoKSB7XHJcbiAgICAgIGxldCBob3VyT2ZUZW1wID0gWy4uLkFycmF5KDE3KS5rZXlzKCldXHJcbiAgICAgIGhvdXJPZlRlbXAgPSBob3VyT2ZUZW1wLnNsaWNlKDIsIDE3KTtcclxuICAgIFxyXG4gICAgICByZXR1cm4gaG91ck9mVGVtcDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZHJhd0NoYXJ0KHRlbXBlcmF0dXJlKSB7XHJcbiAgICAgIGNvbnN0IHRlbXBIb3VycyA9IHRoaXMuZ2V0SG91cnNDb29yZHMoKTtcclxuICAgICAgbGV0IGkgPSAxO1xyXG4gICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy5jdHhcclxuICAgICAgY29uc3QgYmxvY2sgPSB0aGlzLmJsb2Nrcy5iaW5kKHRoaXMpO1xyXG4gICAgICBjb25zdCBheGlzWHBvc2l0aW9uID0gdGhpcy5heGlzWHBvc2l0aW9uO1xyXG4gICAgICBmdW5jdGlvbiBhbmltYXRpb24oKSB7XHJcbiAgICAgICAgaWYgKGkgPD0gdGVtcGVyYXR1cmUubGVuZ3RoKSB7XHJcbiAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcIiNGRkU3NEFcIjtcclxuICAgICAgICBjb250ZXh0LmxpbmVXaWR0aCA9IDM7XHJcbiAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgICAgICBjb250ZXh0Lm1vdmVUbyhibG9jayh0ZW1wSG91cnNbaS0xXSksIGF4aXNYcG9zaXRpb24gLSBibG9jayh0ZW1wZXJhdHVyZVtpLTFdKSk7XHJcbiAgICAgICAgY29udGV4dC5hcmMoYmxvY2sodGVtcEhvdXJzW2ktMV0pLCBheGlzWHBvc2l0aW9uIC0gYmxvY2sodGVtcGVyYXR1cmVbaS0xXSksIDMsIDAsIE1hdGguUEkgKiAyLCB0cnVlKTtcclxuICAgICAgICBjb250ZXh0LmxpbmVUbyhibG9jayh0ZW1wSG91cnNbaV0pLCBheGlzWHBvc2l0aW9uIC0gYmxvY2sodGVtcGVyYXR1cmVbaV0pKTtcclxuICAgICAgICBjb250ZXh0LnN0cm9rZSgpO1xyXG4gICAgICAgIGkrKztcclxuICAgICAgfVxyXG4gICAgICBhbmltYXRpb24oKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgYXN5bmMgd2FpdEZvckdyaWQobXMpIHtcclxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCBtcykpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRNb3VzZVBvc2l0aW9uKGV2dCkge1xyXG4gICAgICBsZXQgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIHg6IGV2dC5jbGllbnRYIC0gcmVjdC5sZWZ0LFxyXG4gICAgICAgIHk6IGV2dC5jbGllbnRZIC0gcmVjdC50b3BcclxuICAgICAgfTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgZmlsdGVyVGVtcGVyYXR1cmUodGVtcGVyYXR1cmUpIHtcclxuICAgICAgY29uc3QgdGVtcCA9IHRlbXBlcmF0dXJlXHJcbiAgICAgICAgLm1hcCgob2JqKSA9PiBvYmoudGVtcClcclxuICAgICAgICAuZmlsdGVyKChlbCwgaW5kZXgpID0+IGluZGV4ICUgMiA9PSAwKTtcclxuICAgIFxyXG4gICAgICByZXR1cm4gdGVtcDtcclxuICAgIH1cclxuICAgIFxyXG4gICAgdGVtcGVyYXR1cmVUb1BpeGVsKHRlbXApe1xyXG4gICAgICB0ZW1wID0gdGVtcC5tYXAoZWwgPT4gdGhpcy5heGlzWHBvc2l0aW9uIC0gdGhpcy5ibG9ja3MoZWwpKTtcclxuICAgICAgcmV0dXJuIHRlbXA7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGhvdXJzVG9QaXhlbChob3Vycykge1xyXG4gICAgICBjb25zdCBob3VycnMgPSBob3Vycy5tYXAoZWwgPT4gdGhpcy5ibG9ja3MoZWwpKTtcclxuICAgICAgcmV0dXJuIGhvdXJycztcclxuICAgIH1cclxuICAgIFxyXG4gICAgY3JlYXRlVGVtcE9iaihob3VyLCB0ZW1wLCBob3VyT2ZUZW1wLCB0ZW1wSW5Ib3VyKXtcclxuICAgICAgY29uc3QgdGVtcFBvaW50Q29vcmRzID0gW107XHJcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGVtcC5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgdGVtcFBvaW50Q29vcmRzLnB1c2goe1xyXG4gICAgICAgICAgeDogaG91cltpXSxcclxuICAgICAgICAgIHk6IHRlbXBbaV0sXHJcbiAgICAgICAgICB4bWluOiBob3VyW2ldIC0gMyxcclxuICAgICAgICAgIHhtYXg6IGhvdXJbaV0gKyAzLFxyXG4gICAgICAgICAgeW1pbjogdGVtcFtpXSAtIDMsXHJcbiAgICAgICAgICB5bWF4OiB0ZW1wW2ldICsgMyxcclxuICAgICAgICAgIGhvdXJUZW1wOiB7XHJcbiAgICAgICAgICAgIGhvdXI6IGhvdXJPZlRlbXBbaV0sXHJcbiAgICAgICAgICAgIHRlbXA6IHRlbXBJbkhvdXJbaV1cclxuICAgICAgICAgIH0sXHJcbiAgICBcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0ZW1wUG9pbnRDb29yZHM7XHJcbiAgICB9XHJcbiAgICBcclxuICAgIGRyYXdQb2ludChjb29yZHMgPSB7fSwgcmFkaXVzLCBjb2xvciA9ICd3aGl0ZScpIHtcclxuICAgICAgY29uc3QgbW91c2VDb29yZGluYXRlID0gY29vcmRzO1xyXG4gICAgICB0aGlzLmN0eC5zdHJva2VTdHlsZSA9IGNvbG9yO1xyXG4gICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcclxuICAgICAgdGhpcy5jdHgubW92ZVRvKG1vdXNlQ29vcmRpbmF0ZS54LCBtb3VzZUNvb3JkaW5hdGUueSk7XHJcbiAgICAgIHRoaXMuY3R4LmFyYyhtb3VzZUNvb3JkaW5hdGUueCwgbW91c2VDb29yZGluYXRlLnksIHJhZGl1cywgMCwgTWF0aC5QSSAqIDIsIHRydWUpO1xyXG4gICAgICB0aGlzLmN0eC5maWxsU3R5bGUgPSBjb2xvcjtcclxuICAgICAgdGhpcy5jdHguZmlsbCgpO1xyXG4gICAgICB0aGlzLmN0eC5zdHJva2UoKTtcclxuICAgIH1cclxuICAgIFxyXG4gIFxyXG4gICAgYWRkUG9wVXAodGVtcFBvaW50KSB7XHJcbiAgICAgIHRoaXMuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgbW91c2VDb29yZHMgPSB0aGlzLmdldE1vdXNlUG9zaXRpb24oZSk7XHJcbiAgICAgICAgbGV0IGJvb29scyA9IHRlbXBQb2ludC5maWx0ZXIoZWwgPT4ge1xyXG4gICAgICAgICAgY29uc3QgYSA9IGVsLnhtaW4gPD0gbW91c2VDb29yZHMueDtcclxuICAgICAgICAgIGNvbnN0IGIgPSBtb3VzZUNvb3Jkcy54IDw9IGVsLnhtYXg7XHJcbiAgICAgICAgICBjb25zdCBjID0gZWwueW1pbiA8PSBtb3VzZUNvb3Jkcy55O1xyXG4gICAgICAgICAgY29uc3QgZCA9IG1vdXNlQ29vcmRzLnkgPD0gZWwueW1heDtcclxuICAgICAgICAgIHJldHVybiAoYSAmJiBiICYmIGMgJiYgZCl9KVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmKGJvb29scy5sZW5ndGgpIHtcclxuICAgICAgICAgIHRoaXMuZHJhd1BvaW50KGJvb29sc1swXSwgMSk7XHJcbiAgICAgICAgICB0aGlzLnN0YXRlID0gey4uLmJvb29sc1swXX07XHJcbiAgICAgICAgICB0aGlzLmNvbmRpdGlvbiA9IHRydWU7XHJcbiAgICAgICAgICBpZiAodGhpcy5jYW52YXMud2lkdGggLSAodGhpcy5zdGF0ZS54ICsgNSkgPD0gODApe1xyXG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUubGVmdCA9IGAke3RoaXMuc3RhdGUueCAtIDg1fXB4YFxyXG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUudG9wID0gYCR7dGhpcy5zdGF0ZS55IC0gMzV9cHhgO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUubGVmdCA9IGAke3RoaXMuc3RhdGUueCArIDV9cHhgO1xyXG4gICAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUudG9wID0gYCR7dGhpcy5zdGF0ZS55IC0gMzV9cHhgO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdGhpcy50b29sdGlwLnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7XHJcbiAgICAgICAgICB0aGlzLnRvb2x0aXAuaW5uZXJIVE1MID0gYFRpbWU6ICR7dGhpcy5zdGF0ZS5ob3VyVGVtcC5ob3VyfTowMCwgVGVtcDogJHt0aGlzLnN0YXRlLmhvdXJUZW1wLnRlbXB9wrBDYDtcclxuICAgICAgICB9IFxyXG4gICAgICAgIGVsc2UgaWYoIWJvb29scy5sZW5ndGgpIHtcclxuICAgICAgICAgIHRoaXMuZHJhd1BvaW50KHRoaXMuc3RhdGUsIDMsIFwiI0ZGRTc0QVwiKTtcclxuICAgICAgICAgIHRoaXMuY29uZGl0aW9uID0gZmFsc2U7XHJcbiAgICAgICAgICB0aGlzLnN0YXRlID0ge307XHJcbiAgICAgICAgICB0aGlzLnRvb2x0aXAuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICB9IFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBhc3luYyBjaGFydCgpIHtcclxuICAgICAgY29uc3QgaG91ck9mV2VhdGhlciA9IHRoaXMubWFwQW5kRmlsdGVyKHRoaXMud2VhdGhlckJ5SG91ci5tYXAoKG9iaikgPT4gb2JqLmR0KSk7XHJcbiAgICAgIGxldCB0ZW1wZXJhdHVyZSA9IHRoaXMuZmlsdGVyVGVtcGVyYXR1cmUodGhpcy53ZWF0aGVyQnlIb3VyKTtcclxuICAgICAgY29uc3QgdGVtcGVyYXR1cmVDb29yZHMgPSB0aGlzLnRlbXBlcmF0dXJlVG9DaGFydENvb3Jkcyh0ZW1wZXJhdHVyZSk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCB0ZW1wUGl4ZWxzID0gdGhpcy50ZW1wZXJhdHVyZVRvUGl4ZWwodGVtcGVyYXR1cmVDb29yZHMsIHRoaXMuYXhpc1hwb3NpdGlvbik7XHJcbiAgICAgIGNvbnN0IGhvdXJzUGl4ZWxzID0gdGhpcy5ob3Vyc1RvUGl4ZWwodGhpcy5nZXRIb3Vyc0Nvb3JkcygpKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHRlbXBQb2ludHMgPSB0aGlzLmNyZWF0ZVRlbXBPYmooaG91cnNQaXhlbHMsIHRlbXBQaXhlbHMsIGhvdXJPZldlYXRoZXIsIHRlbXBlcmF0dXJlKTtcclxuICAgIFxyXG4gICAgICB0aGlzLmNhbnZhc0RpbWVuc2lvbnMoKTtcclxuICAgICAgdGhpcy5kcmF3R3JpZCgpO1xyXG4gICAgICB0aGlzLmRyYXdBeGlzKGhvdXJPZldlYXRoZXIpO1xyXG4gICAgICBhd2FpdCB0aGlzLndhaXRGb3JHcmlkKDUwMCk7XHJcbiAgICAgIHRoaXMuZHJhd0NoYXJ0KHRlbXBlcmF0dXJlQ29vcmRzKVxyXG4gICAgICB0aGlzLmFkZFBvcFVwKHRlbXBQb2ludHMpO1xyXG4gICAgfVxyXG4gIFxyXG4gIH0iLCJleHBvcnQgY2xhc3MgV2Vla0ZvcmVjYXN0IHtcclxuICBjb25zdHJ1Y3Rvcih3ZWVrRm9yZWNhc3REYXRhKSB7XHJcbiAgICB0aGlzLndlZWtEYXRhID0gd2Vla0ZvcmVjYXN0RGF0YTtcclxuICAgIHRoaXMud2VhdGhlckZvcmVjYXN0Q29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcclxuICAgICAgXCJ3ZWF0aGVyRm9yZWNhc3QtLWpzXCJcclxuICAgICk7XHJcbiAgICB0aGlzLndlYXRoZXJGb3JlY2FzdENvbnRhaW5lciA9IHRoaXMud2VhdGhlckZvcmVjYXN0Q29udGFpbmVyWzBdO1xyXG4gIH1cclxuXHJcbiAgc2xpY2VXZWVrRGF0YUFycmF5KCkge1xyXG4gICAgdGhpcy53ZWVrRGF0YSA9IHRoaXMud2Vla0RhdGEuc2xpY2UoMSwgOCk7XHJcbiAgfVxyXG5cclxuICBnZXRUaW1lc3RhbXBUb1RpbWUodGltZXN0YW1wKSB7XHJcbiAgICBjb25zdCB0aW1lID0gbmV3IERhdGUodGltZXN0YW1wICogMTAwMCk7XHJcbiAgICByZXR1cm4gdGltZS5nZXREYXkoKTtcclxuICB9XHJcblxyXG4gIGdldE5hbWVPZldlZWsobnVtYmVyKSB7XHJcbiAgICBzd2l0Y2ggKG51bWJlcikge1xyXG4gICAgICBjYXNlIDA6XHJcbiAgICAgICAgcmV0dXJuIFwiU3VuXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgMTpcclxuICAgICAgICByZXR1cm4gXCJNb25cIjtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAyOlxyXG4gICAgICAgIHJldHVybiBcIlR1ZVwiO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIDM6XHJcbiAgICAgICAgcmV0dXJuIFwiV2VkXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgNDpcclxuICAgICAgICByZXR1cm4gXCJUaHVyXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgNTpcclxuICAgICAgICByZXR1cm4gXCJGcmlcIjtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSA2OlxyXG4gICAgICAgIHJldHVybiBcIlNhdFwiO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuICBnZXRXZWF0aGVyUGFyYW1ldGVycygpIHtcclxuICAgIHRoaXMud2Vla0RhdGEgPSB0aGlzLndlZWtEYXRhLm1hcCgoZWwpID0+IHtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBkYXk6IHRoaXMuZ2V0TmFtZU9mV2Vlayh0aGlzLmdldFRpbWVzdGFtcFRvVGltZShlbC5kdCkpLFxyXG4gICAgICAgIHRlbXA6IGVsLnRlbXAuZGF5LFxyXG4gICAgICAgIHdlYXRoZXI6IGVsLndlYXRoZXJbMF0ubWFpbixcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG4gICAgY29uc29sZS5sb2codGhpcy53ZWVrRGF0YSk7XHJcbiAgfVxyXG5cclxuICBwdXRXZWF0aGVySW50b1NlY3Rpb24oKSB7XHJcbiAgICB0aGlzLndlYXRoZXJGb3JlY2FzdENvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xyXG4gICAgdGhpcy53ZWVrRGF0YS5mb3JFYWNoKChlbCkgPT4ge1xyXG4gICAgICB0aGlzLndlYXRoZXJGb3JlY2FzdENvbnRhaW5lci5pbm5lckhUTUwgKz0gYDxkaXYgY2xhc3M9XCJ3ZWF0aGVyRm9yZWNhc3RfX2RheSB3ZWF0aGVyRm9yZWNhc3RfX2RheS0tanNcIj48aW1nIGNsYXNzPVwid2VhdGhlckZvcmVjYXN0X19kYXlFbGVtZW50XCIgc3JjPSdhc3NldHMvaW1nL3dlYXRoZXJJY29ucy8ke3RoaXMud2VhdGhlckljb24oXHJcbiAgICAgICAgZWwud2VhdGhlclxyXG4gICAgICApfScgYWx0PScnPjwvaW1nPjxkaXYgY2xhc3M9XCJ3ZWF0aGVyRm9yZWNhc3RfX2RheUVsZW1lbnRcIj48cD4ke1xyXG4gICAgICAgIGVsLmRheVxyXG4gICAgICB9PGJyPiR7ZWwudGVtcH08L3A+PC9kaXY+PC9kaXY+YDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkV2VhdGhlckZvcmVjYXN0KCkge1xyXG4gICAgdGhpcy5zbGljZVdlZWtEYXRhQXJyYXkoKTtcclxuICAgIHRoaXMuZ2V0V2VhdGhlclBhcmFtZXRlcnMoKTtcclxuICAgIHRoaXMucHV0V2VhdGhlckludG9TZWN0aW9uKCk7XHJcbiAgfVxyXG5cclxuICB3ZWF0aGVySWNvbih3ZWF0aGVyKSB7XHJcbiAgICBsZXQgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgY3VycmVudERhdGUgPSBjdXJyZW50RGF0ZS5nZXRIb3VycygpO1xyXG4gICAgc3dpdGNoICh3ZWF0aGVyKSB7XHJcbiAgICAgIGNhc2UgXCJ0aHVuZGVyc3Rvcm1cIjpcclxuICAgICAgICByZXR1cm4gXCJTdG9ybS5zdmdcIjtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIkRyaXp6bGVcIjpcclxuICAgICAgICByZXR1cm4gXCJEcml6emxlLnN2Z1wiO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFwiUmFpblwiOlxyXG4gICAgICAgIHJldHVybiBcIlJhaW4uc3ZnXCI7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJTbm93XCI6XHJcbiAgICAgICAgcmV0dXJuIFwiU25vd2ZsYWtlLnN2Z1wiO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgICBjYXNlIFwiQXRtb3NwaGVyZVwiOlxyXG4gICAgICAgIHJldHVybiBcIkZvZy5zdmdcIjtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIkNsZWFyXCI6XHJcbiAgICAgICAgaWYgKGN1cnJlbnREYXRlIDw9IDIwKSB7XHJcbiAgICAgICAgICByZXR1cm4gXCJTdW4uc3ZnXCI7XHJcbiAgICAgICAgICBicmVhaztcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgcmV0dXJuIFwiTW9vbi5zdmdcIjtcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgICAgY2FzZSBcIkNsb3Vkc1wiOlxyXG4gICAgICAgIHJldHVybiBcIkNsb3Vkcy5zdmdcIjtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiXCJ1c2Ugc3RyaWN0XCI7XHJcbmltcG9ydCB7IFdlYXRoZXJJbmZvcm1hdGlvbiB9IGZyb20gXCIuL3dlYXRoZXJJbmZvcm1hdGlvbkNsYXNzLmpzXCI7XHJcbmltcG9ydCB7IENoYXJ0IH0gZnJvbSBcIi4vY2hhcnRDbGFzcy5qc1wiO1xyXG5pbXBvcnQgeyBXZWVrRm9yZWNhc3QgfSBmcm9tIFwiLi93ZWVrRm9yZWNhc3RDbGFzcy5qc1wiO1xyXG4vLyBzZXJ2aWNlIHdvcmtlciByZWdpc3RyYXRpb24gLSByZW1vdmUgaWYgeW91J3JlIG5vdCBnb2luZyB0byB1c2UgaXRcclxuXHJcbmlmIChcInNlcnZpY2VXb3JrZXJcIiBpbiBuYXZpZ2F0b3IpIHtcclxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoXCJzZXJ2aWNld29ya2VyLmpzXCIpLnRoZW4oXHJcbiAgICAgIGZ1bmN0aW9uIChyZWdpc3RyYXRpb24pIHtcclxuICAgICAgICAvLyBSZWdpc3RyYXRpb24gd2FzIHN1Y2Nlc3NmdWxcclxuICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgIFwiU2VydmljZVdvcmtlciByZWdpc3RyYXRpb24gc3VjY2Vzc2Z1bCB3aXRoIHNjb3BlOiBcIixcclxuICAgICAgICAgIHJlZ2lzdHJhdGlvbi5zY29wZVxyXG4gICAgICAgICk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAvLyByZWdpc3RyYXRpb24gZmFpbGVkIDooXHJcbiAgICAgICAgY29uc29sZS5sb2coXCJTZXJ2aWNlV29ya2VyIHJlZ2lzdHJhdGlvbiBmYWlsZWQ6IFwiLCBlcnIpO1xyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vLyBwbGFjZSB5b3VyIGNvZGUgYmVsb3dcclxuY29uc3QgYXBpS2V5ID0gXCI1M2M1ZTk3Njc1YzhkM2Q4ZGEwN2U1NmFlYzVhM2EyMlwiO1xyXG5jb25zdCBheGlzWHBvc2l0aW9uID0gMjgwOyAvLyBYIGF4aXMgaXMgb24gMjgwcHggQ2FudmFzIEhlaWdodDtcclxubGV0IGNsYXNzU3RhdHVzID0gZmFsc2U7XHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG4gIGxldCBsYXN0VGltZSA9IDA7XHJcbiAgbGV0IHZlbmRvcnMgPSBbXCJtc1wiLCBcIm1velwiLCBcIndlYmtpdFwiLCBcIm9cIl07XHJcbiAgZm9yIChsZXQgeCA9IDA7IHggPCB2ZW5kb3JzLmxlbmd0aCAmJiAhd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZTsgKyt4KSB7XHJcbiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gd2luZG93W3ZlbmRvcnNbeF0gKyBcIlJlcXVlc3RBbmltYXRpb25GcmFtZVwiXTtcclxuICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZSA9XHJcbiAgICAgIHdpbmRvd1t2ZW5kb3JzW3hdICsgXCJDYW5jZWxBbmltYXRpb25GcmFtZVwiXSB8fFxyXG4gICAgICB3aW5kb3dbdmVuZG9yc1t4XSArIFwiQ2FuY2VsUmVxdWVzdEFuaW1hdGlvbkZyYW1lXCJdO1xyXG4gIH1cclxuXHJcbiAgaWYgKCF3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKVxyXG4gICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA9IGZ1bmN0aW9uIChjYWxsYmFjaywgZWxlbWVudCkge1xyXG4gICAgICBsZXQgY3VyclRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgbGV0IHRpbWVUb0NhbGwgPSBNYXRoLm1heCgwLCAxNiAtIChjdXJyVGltZSAtIGxhc3RUaW1lKSk7XHJcbiAgICAgIGxldCBpZCA9IHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBjYWxsYmFjayhjdXJyVGltZSArIHRpbWVUb0NhbGwpO1xyXG4gICAgICB9LCB0aW1lVG9DYWxsKTtcclxuICAgICAgbGFzdFRpbWUgPSBjdXJyVGltZSArIHRpbWVUb0NhbGw7XHJcbiAgICAgIHJldHVybiBpZDtcclxuICAgIH07XHJcblxyXG4gIGlmICghd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lKVxyXG4gICAgd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lID0gZnVuY3Rpb24gKGlkKSB7XHJcbiAgICAgIGNsZWFyVGltZW91dChpZCk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG5cclxuZnVuY3Rpb24gZXJyb3IoZXJyKSB7XHJcbiAgY29uc29sZS53YXJuKGBFUlJPUigke2Vyci5jb2RlfSk6ICR7ZXJyLm1lc3NhZ2V9YCk7XHJcbn1cclxuXHJcbmNvbnN0IG9wdGlvbnMgPSB7XHJcbiAgZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlLFxyXG4gIHRpbWVvdXQ6IDUwMDAsXHJcbiAgbWF4aW11bUFnZTogMCxcclxufTtcclxuXHJcbmZ1bmN0aW9uIGxvY2F0aW9uKCkge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PlxyXG4gICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihyZXNvbHZlLCBlcnJvcilcclxuICApO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBnZXRMb2NhdGlvbihsb2NhdGlvbikge1xyXG4gIGxldCBwb3NpdGlvbiA9IGxvY2F0aW9uO1xyXG4gIGxldCB3ZWF0aGVyQnlQb3NpdGlvbjtcclxuICBsZXQgd2VhdGhlckJ5SG91cjtcclxuICBsZXQgbmV4dFNldmVuRGF5cztcclxuICBpZiAodHlwZW9mIHBvc2l0aW9uID09PSBcIm9iamVjdFwiKSB7XHJcbiAgICBwb3NpdGlvbiA9IGF3YWl0IHBvc2l0aW9uLmNvb3JkcztcclxuICAgIGNvbnN0IHsgbGF0aXR1ZGUsIGxvbmdpdHVkZSB9ID0gcG9zaXRpb247XHJcblxyXG4gICAgd2VhdGhlckJ5UG9zaXRpb24gPSBhd2FpdCBmZXRjaChcclxuICAgICAgYGh0dHBzOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS93ZWF0aGVyP2xhdD0ke2xhdGl0dWRlfSZsb249JHtsb25naXR1ZGV9JmFwcGlkPSR7YXBpS2V5fSZ1bml0cz1tZXRyaWMmbGFuZz1wbGBcclxuICAgICk7XHJcbiAgICB3ZWF0aGVyQnlQb3NpdGlvbiA9IGF3YWl0IHdlYXRoZXJCeVBvc2l0aW9uLmpzb24oKTtcclxuXHJcbiAgICB3ZWF0aGVyQnlIb3VyID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS9vbmVjYWxsP2xhdD0ke2xhdGl0dWRlfSZsb249JHtsb25naXR1ZGV9JlxyXG4gICAgZXhjbHVkZT1ob3VybHkmYXBwaWQ9JHthcGlLZXl9JnVuaXRzPW1ldHJpY2ApO1xyXG4gICAgd2VhdGhlckJ5SG91ciA9IGF3YWl0IHdlYXRoZXJCeUhvdXIuanNvbigpO1xyXG4gICAgd2VhdGhlckJ5SG91ciA9IHdlYXRoZXJCeUhvdXIuaG91cmx5O1xyXG5cclxuICAgIG5leHRTZXZlbkRheXMgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L29uZWNhbGw/bGF0PSR7bGF0aXR1ZGV9Jmxvbj0ke2xvbmdpdHVkZX0mXHJcbiAgICBleGNsdWRlPWRhaWx5JmFwcGlkPSR7YXBpS2V5fSZ1bml0cz1tZXRyaWNgKTtcclxuICAgIG5leHRTZXZlbkRheXMgPSBhd2FpdCBuZXh0U2V2ZW5EYXlzLmpzb24oKTtcclxuICAgIG5leHRTZXZlbkRheXMgPSBuZXh0U2V2ZW5EYXlzLmRhaWx5O1xyXG4gIH0gZWxzZSB7XHJcbiAgICB3ZWF0aGVyQnlQb3NpdGlvbiA9IGF3YWl0IGZldGNoKFxyXG4gICAgICBgaHR0cHM6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L3dlYXRoZXI/cT0ke3Bvc2l0aW9ufSZhcHBpZD0ke2FwaUtleX0mdW5pdHM9bWV0cmljYFxyXG4gICAgKTtcclxuICAgIHdlYXRoZXJCeVBvc2l0aW9uID0gYXdhaXQgd2VhdGhlckJ5UG9zaXRpb24uanNvbigpO1xyXG5cclxuICAgIGNvbnN0IGNvb3JkcyA9IHdlYXRoZXJCeVBvc2l0aW9uLmNvb3JkO1xyXG4gICAgY29uc29sZS5sb2coY29vcmRzKTtcclxuICAgIHdlYXRoZXJCeUhvdXIgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L29uZWNhbGw/bGF0PSR7Y29vcmRzLmxhdH0mbG9uPSR7Y29vcmRzLmxvbn0mXHJcbiAgICBleGNsdWRlPWhvdXJseSZhcHBpZD0ke2FwaUtleX0mdW5pdHM9bWV0cmljYCk7XHJcbiAgICB3ZWF0aGVyQnlIb3VyID0gYXdhaXQgd2VhdGhlckJ5SG91ci5qc29uKCk7XHJcblxyXG4gICAgd2VhdGhlckJ5SG91ciA9IHdlYXRoZXJCeUhvdXIuaG91cmx5O1xyXG5cclxuICAgIG5leHRTZXZlbkRheXMgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L29uZWNhbGw/bGF0PSR7Y29vcmRzLmxhdH0mbG9uPSR7Y29vcmRzLmxvbn0mXHJcbiAgICBleGNsdWRlPWRhaWx5JmFwcGlkPSR7YXBpS2V5fSZ1bml0cz1tZXRyaWNgKTtcclxuICAgIG5leHRTZXZlbkRheXMgPSBhd2FpdCBuZXh0U2V2ZW5EYXlzLmpzb24oKTtcclxuICAgIG5leHRTZXZlbkRheXMgPSBuZXh0U2V2ZW5EYXlzLmRhaWx5O1xyXG4gIH1cclxuXHJcbiAgY29uc3Qgd2VhdGhlckRhdGEgPSBuZXcgV2VhdGhlckluZm9ybWF0aW9uKHdlYXRoZXJCeVBvc2l0aW9uKTtcclxuICB3ZWF0aGVyRGF0YS5zZXRXZWF0aGVySW5mb3JtYXRpb24oKTtcclxuICBjb25zdCBjaGFydCA9IG5ldyBDaGFydCh3ZWF0aGVyQnlIb3VyLCBheGlzWHBvc2l0aW9uKTtcclxuICBjaGFydC5jaGFydCgpO1xyXG4gIGNvbnN0IGZvcmVjYXN0Rm9yV2VlayA9IG5ldyBXZWVrRm9yZWNhc3QobmV4dFNldmVuRGF5cyk7XHJcbiAgZm9yZWNhc3RGb3JXZWVrLmFkZFdlYXRoZXJGb3JlY2FzdCgpO1xyXG59XHJcblxyXG5jb25zdCBsb2NhbGl6YXRpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxyXG4gIFwiaGVhZGVyX19nZW9sb2NhbGl6YXRpb24tLWJ1dHRvbkpTXCJcclxuKVswXTtcclxuY29uc3Qgc2VhcmNoQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcclxuICBcImhlYWRlcl9fc2VhcmNoLS1idXR0b25KU1wiXHJcbilbMF07XHJcbmNvbnN0IGlucHV0RmllbGQgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFxyXG4gIFwiaGVhZGVyX19zZWFyY2gtLWlucHV0SlNcIlxyXG4pWzBdO1xyXG5cclxubG9jYWxpemF0aW9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBhc3luYyAoKSA9PiB7XHJcbiAgY29uc3QgbG9jYXRpb25zID0gYXdhaXQgbG9jYXRpb24oKTtcclxuICBhd2FpdCBnZXRMb2NhdGlvbihsb2NhdGlvbnMpO1xyXG4gIGlmICghY2xhc3NTdGF0dXMpIHtcclxuICAgIHJlcGxhY2VDbGFzc2VzKCk7XHJcbiAgICBjbGFzc1N0YXR1cyA9IHRydWU7XHJcbiAgfVxyXG59KTtcclxuXHJcbnNlYXJjaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgYXN5bmMgKCkgPT4ge1xyXG4gIGlmICghaW5wdXRGaWVsZC52YWx1ZSkge1xyXG4gICAgYWxlcnQoXCJwbGVhc2UgdHlwZSB5b3VyIGNpdHkgbmFtZVwiKTtcclxuICB9IGVsc2UgaWYgKGlucHV0RmllbGQudmFsdWUpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IGdldExvY2F0aW9uKGlucHV0RmllbGQudmFsdWUpO1xyXG5cclxuICAgICAgaWYgKCFjbGFzc1N0YXR1cykge1xyXG4gICAgICAgIHJlcGxhY2VDbGFzc2VzKCk7XHJcbiAgICAgICAgY2xhc3NTdGF0dXMgPSB0cnVlO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBhbGVydChcIlBsZWFzZSB0eXBlIGNvcnJldCBjaXR5IG5hbWVcIik7XHJcbiAgICB9XHJcbiAgfVxyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHJlcGxhY2VDbGFzc2VzKCkge1xyXG4gIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJoZWFkZXItLWZpcnN0TG9hZFwiKVswXTtcclxuICBjb25zdCBtYWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcIm1haW5fX2NvbnRhaW5lci0tZmlyc3RMb2FkXCIpWzBdO1xyXG4gIGNvbnN0IGZvb3RlciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJmb290ZXItLWZpcnN0TG9hZFwiKVswXTtcclxuXHJcbiAgaGVhZGVyLmNsYXNzTGlzdC5yZXBsYWNlKFwiaGVhZGVyLS1maXJzdExvYWRcIiwgXCJoZWFkZXJcIik7XHJcbiAgbWFpbi5jbGFzc0xpc3QucmVwbGFjZShcIm1haW5fX2NvbnRhaW5lci0tZmlyc3RMb2FkXCIsIFwibWFpbl9fY29udGFpbmVyXCIpO1xyXG4gIGZvb3Rlci5jbGFzc0xpc3QucmVwbGFjZShcImZvb3Rlci0tZmlyc3RMb2FkXCIsIFwiZm9vdGVyX19pbWFnZVwiKTtcclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///0\n')}]);